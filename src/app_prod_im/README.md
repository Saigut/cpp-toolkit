### Interface definitions

------------------------------
1. Server
    * Register
    * Message
    * Contacts list

2. Client
    * Message

------------------------------
3. Modules in Server
    * Session manager
        * ...
    * ...


--------
### 功能梳理
#### 功能列表
1. 客户端
   * 注册
   * 登录
   * 管理联系人
   * 向联系人发消息
   * 接收消息

2. 服务端
   * 用户注册
   * 用户登录
   * 用户联系人管理
   * 转发消息

#### 功能流程
1. 注册
   客户端发起注册->服务端同意注册->服务端建立用户信息->成功
2. 登录
   客户端用户登录->服务端检查用户ID和密码->服务端建立用户会话->客户端建立登录会话->成功
3. 联系人管理
   * 获取联系人列表
     客户端请求联系人列表->服务端返回联系人列表
   * 添加联系人
     客户端请求添加联系人->服务端为用户添加联系人->成功->客户端本地添加联系人
   * 移除联系人
     客户端请求移除联系人->服务端为用户移除联系人->成功->客户端本地移除联系人
4. 发消息
   * 客户端向指定联系人发送消息->消息发往服务端->服务端查找目的联系人会话->向目的联系人转发消息

### 模块
#### 模块划分
1. 客户端
   * 登录会话
   * 联系人管理
   * 消息发送
   * 消息接收

2. 服务端
   * 用户信息
   * 用户会话
   * 消息接收
   * 消息转发

#### 模块接口
1. 客户端接口
   对服务端的接口：
   * 接收消息
   
   命令行接口：
   * 注册
   ```shell
   ./<program> reg <user id>
   ```
   * 登录
   ```shell
   ./<program> login <user id>
   ```
   ```
   * 获取联系人列表
   ```shell
   ./<program> cont_list <user id>
   ```
   * 添加联系人
   ```shell
   ./<program> cont_add <contact user id>
   ```
   * 移除联系人
   ```shell
   ./<program> cont_del <contact user id>
   ```
   * 向联系人发送消息
   ```shell
   ./<program> msg <contact user id> <message>
   ```

2. 服务端接口
   对客户端的接口：
   * 注册
   * 登录
   * 获取联系人列表
   * 添加联系人
   * 移除联系人
   * 接收消息

   命令行接口：
   * 启动
   ```shell
   ./<program>
   ```
   
3. 客户端内部模块接口
   
4. 服务端内部模块接口